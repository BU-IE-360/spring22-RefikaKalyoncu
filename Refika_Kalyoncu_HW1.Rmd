---
title: "IE360 Spring 2022"
author: "Refika Kalyoncu"
output:
  html_document:
    toc: yes
    toc_depth: 3
    toc_float: yes
    number_sections: yes
    code_folding: hide
    theme: readable
subtitle: Homework 1
---

# Introduction

  Since the increases in exchange rates increase the costs of the producers, they are also reflected in the sales prices, which causes inflation to rise. Inflation, on the other hand, is a situation that expresses a continuous and noticeable increase in the general level of prices. Another definition is the increase in nominal national income relative to the amount of goods purchased with this income. In this case, with the increase in the exchange rate, the purchasing power of people decreases. Based on this information, in this report, the relationship between the exchange rate increase and the housing price index was observed with the data obtained from [EVDS](https://evds2.tcmb.gov.tr/index.php?/evds/serieMarket).
  Generally, higher interest rates are a policy response to rising inflation. Because if there is inflation somewhere, when you lend money without interest, the purchasing power of money decreases in the time it takes to get this money back. Interest, on the other hand, prevents a decrease in the purchasing power of money. Therefore, the higher the inflation, the higher the interest rate. Considering the relationship between exchange rate and inflation, and the relationship between inflation and interest, it is thought that there is a positive relationship between exchange rate and interest rates, and this is also examined in the report.
  So many this report answers the question: "Are there any relationships between exchange rate, housing price index and housing interest rate?"


# Analysis

```{r message=FALSE,warning=FALSE}
library(ggplot2)
library(dplyr)
library(tidyr)
library(readxl)
library(lubridate)
library(zoo)
library(corrplot)
library(hrbrthemes)
library(viridis)
library(ggridges)

setwd("C:/Users/HP/Desktop/IE360_HW1/HW2")

data<-read_excel("mydata.xlsx")  

data<-data%>%rename(Date=Date,
                      ExchangeRate_EUR=`Euro(Buying)`, 
                      Housing.InterestRate=`Housing(Interest Rate)`,
                      Housing.PriceIndex=`RPPI`,
                      Apartment.for.sale=`Satılık Daire`)%>%
  mutate(Date=as.Date(as.yearmon(Date)))


```

## Analysis with the Real Values 

### Visualization of Time Series

Monthly time series data are given below:

```{r message=FALSE,warning=FALSE}
ggplot(data,aes(x=Date))+
  geom_line(size=1,color="yellow",aes(y=ExchangeRate_EUR))+
  theme_ipsum()+
  ggtitle("Time Series of Exchange Rate EUR/TRY",
          subtitle="Between the Years 2013-2021")

ggplot(data,aes(x=Date))+
  geom_line(size=1,color="blue",aes(y=Housing.InterestRate))+
  theme_ipsum()+
  ggtitle("Time Series of Housing Interest Rate",
          subtitle="Between the Years 2013-2021")

ggplot(data,aes(x=Date))+
  geom_line(size=1,color="purple",aes(y=Housing.PriceIndex))+
  theme_ipsum()+
  ggtitle("Time Series of Housing Price Index",
          subtitle="Between the Years 2013-2021")
```

Even if we look through the plots directly a relationship betweeen housing price index and exchange rate can be clearly seen. So they should be highly correlated. 
Compared to exchange rate and price index, there are big fluctuations in interest rate. 
Until late 2018 the interest rate increases with significant fluctuations. In late 2018 it has a big increase due central bank policies. Then in 2019 it decreases sharply. During the pandemic the interest rate decreased as well to diminish the effects of pandemic. 

```{r}

boxplot(data$Housing.PriceIndex,data$Housing.InterestRate,data$ExchangeRate_EUR,xlab = "Parts Per Billion",
main = "Multiple boxplots for comparision",
names = c("price index","interest rate","euro"),
las = 2,
col = c("orange","red","yellow"),
border = "brown",
horizontal = TRUE,
notch = TRUE)

```

### Visualization of Distributions 


```{r message=FALSE,warning=FALSE}
dist1<-data%>%
  ggplot(.,aes(x=ExchangeRate_EUR))+
  geom_density(color="darkgrey",fill="yellow",adjust=1.5, alpha=.4) +
  theme_ipsum()+
  ggtitle("Distribution of Exchange Rate Values")
dist1
print(paste("Variance of Exchange Rate Values:", var(data$ExchangeRate_EUR)))
print(paste("Mean of Exchange Rate Values:",mean(data$ExchangeRate_EUR)))

dist1+
  facet_wrap(~year(Date))
```


```{r message=FALSE,warning=FALSE}
ggplot(data, aes(ExchangeRate_EUR))+geom_histogram(bins=10,color="yellow",fill="yellow")+ggtitle("Histogram for Exchange Rates") + xlab("Exchange Rates") + ylab("Density")
```

  The exchange rate increases almost exponentially so the variance increases as the time flows.If we look through the histogram almost half of the data is gathered between the interval of 0-4 and other intervals consist of comparably small portions of data. Which shows that the data was stable between 0-4 for sometime then it started to increase sharply.  

```{r message=FALSE,warning=FALSE}
dist3<-data%>%
  ggplot(.,aes(x=Housing.InterestRate))+
  geom_density(color="darkgrey",fill="green",adjust=1.5, alpha=.4) +
  theme_ipsum()+
  ggtitle("Distribution of Interest Rate Values")
dist3
print(paste("Variance of Interest Rate Values:",var(data$Housing.InterestRate)))
print(paste("Mean of Interest Rate Values:",mean(data$Housing.InterestRate)))

dist3+
  facet_wrap(~year(Date))
```

```{r}
ggplot(data, aes(Housing.InterestRate))+geom_histogram(bins=10,color="green",fill="green")+ggtitle("Histogram for Interest Rates") + xlab("Interest Rate") + ylab("Density")
```
????



```{r message=FALSE,warning=FALSE}
dist2<-data%>%
  ggplot(.,aes(x=Housing.PriceIndex))+
  geom_density(color="darkgrey",fill="purple",adjust=1.5, alpha=.4) +
  theme_ipsum()+
  ggtitle("Distribution of Hosing Price Index")
dist2
print(paste("Variance of Housing Price Index:",var(data$Housing.PriceIndex)))
print(paste("Mean of Housing Price Index:",mean(data$Housing.PriceIndex)))

dist2+
  facet_wrap(~year(Date))

```

```{r}
ggplot(data, aes(Housing.PriceIndex))+geom_histogram(bins=10,color="purple",fill="purple")+ggtitle("Histogram for Housing Price Index") + xlab("Housing Price Index") + ylab("Density")
```

??????????????????

### Visualization of Pairwise Correlations

To understand the relationships between the data we can look for the correlation value. 


```{r message=FALSE,warning=FALSE}
cor_numVar <- cor(data[,c(2,3,5)], use="pairwise.complete.obs") 

corrplot.mixed(cor_numVar, tl.col="black", tl.pos = "lt")

```

  The correlation value shows that housing price index and the exchange rate is highly correlated. The perfectly correlated value is 1 and our value is 0.97 which shows almost the perfect correlation.
  The correlation value between interest rate and exchange rate is also positive and above 0.5. Which proves that there exist a positive relation between exchange and interest rate which may be due to as exchange rate increases the inflation rate increases so the interest rate. 


## Analysis with the Normalized Values 

### Visualization of Time Series

To compare values on a single plot we are going to normalize the values of our data. To do this we are going to subtract min of each data from the actual value and divide it to max-min value of the data. So that each value will be between zero and 1. 

```{r message=FALSE,warning=FALSE}
min1<-min(data$ExchangeRate_EUR)
max1<-max(data$ExchangeRate_EUR)
min2<-min(data$Housing.InterestRate)
max2<-max(data$Housing.InterestRate)
min4<-min(data$Housing.PriceIndex)
max4<-max(data$Housing.PriceIndex)

data<-data%>%mutate(N_ExchangeRate_EUR=(ExchangeRate_EUR-min1)/(max1-min1),
              N_Housing.InterestRate=(Housing.InterestRate-min2)/(max2-min2),
              N_Housing.PriceIndex=(Housing.PriceIndex-min4)/(max4-min4))

```

```{r message=FALSE,warning=FALSE}
data%>%pivot_longer(.,cols=c(N_ExchangeRate_EUR,N_Housing.InterestRate,N_Housing.PriceIndex),
                    names_to="name",
                    values_to="values")%>%
  ggplot(.,aes(x=Date,y=values,color=name,shape=name))+
  geom_line(size=1)+
  labs(color="Normalized Economic Measures",
       y="Normalized Values")+
  scale_colour_discrete()+
  theme_ipsum()+
  ggtitle("Comparison of Time Series",
          subtitle="With the Normalized Values")

```

As one can see price index and exchange rate increases almost smoothly compared to Interest rate. The interest rate is being determined according to the change in economy and also changes in economic policies and they are not applied instantly which maybe the reason of enormous fluctuations. This may be the reason for comparably less correlation. 

### Visualization of Distributions

```{r message=FALSE,warning=FALSE}
norm1<-data%>%pivot_longer(.,cols=c(N_ExchangeRate_EUR,N_Housing.InterestRate,N_Housing.PriceIndex),
                    names_to="name",
                    values_to="values")%>%
  ggplot(.,aes(x=values,y=factor(name),fill=factor(name)))+
  geom_density_ridges() +
  labs(color="Normalized Economic Measures",
       y="Normalized Values")+
  theme_ipsum()+
  theme(legend.position = "none")+
  ggtitle("Distribution of the Normalized Values")
norm1

print(paste("Variance of the Normalized Exchange Rate:",var(data$N_ExchangeRate_EUR)))
print(paste("Variance of the Normalized Interest Rate:",var(data$N_Housing.InterestRate)))
print(paste("Variance of the Normalized Price Index:",var(data$N_Housing.PriceIndex)))
norm1+
  facet_wrap(~year(Date))

```

The variance values are really close. Also we observe that the yearly distribution of exchange and interest rates are so similar. 


### Visualization of Pairwise Correlations

```{r message=FALSE,warning=FALSE}
d<-data%>%group_by(year(Date))%>%
  mutate(ExchangeRateEUR_HousingInterestRate=cor(N_ExchangeRate_EUR,N_Housing.InterestRate),
         ExchangeRateEUR_HousingPriceIndex=cor(N_ExchangeRate_EUR,N_Housing.PriceIndex),
         HousingPriceIndex_HousingInterestRate=cor(N_Housing.InterestRate,N_Housing.PriceIndex))


d%>%
  pivot_longer(.,cols=c(ExchangeRateEUR_HousingInterestRate,ExchangeRateEUR_HousingPriceIndex,HousingPriceIndex_HousingInterestRate))%>%
  ggplot(., aes(x=year(Date), y=value)) +
  geom_line( aes(color=name)) +
  geom_point(aes( fill=name),shape=21, color="black", size=6) +
  theme_ipsum()+
  labs(fill="Between:",color="Between:",
       y="Correlation",
       x="Year")+
  facet_wrap(~name)+
  ggtitle("Pairwise Yearly Correlations")+
  theme(legend.position = "bottom",
        axis.text.x = element_text(angle = 45, hjust = 1),
        strip.text.x = element_blank())+
  scale_fill_discrete(labels=c("ExchangeRate-InterestRate","ExchangeRate-HPriceIndex","HPriceIndex-InterestRate"))+
  scale_color_discrete(labels=c("ExchangeRate-InterestRate","ExchangeRate-HPriceIndex","HPriceIndex-InterestRate"))

```

YORUM!!!


# Google Trend 

I searched for "Satılık daire" in Google trend to see what is the relation between searching for houses and price indexes. It seems that as the price increases people tend to search more for apartments for sale. As a result of not being able to find an affordable house, people search for a house for much longer time.Therefore the amount of searching for the "Satılık daire" may be increasing. 

```{r message=FALSE,warning=FALSE}
cor_numVar <- cor(data[,c(2,3,4,5)], use="pairwise.complete.obs") 

corrplot.mixed(cor_numVar, tl.col="black", tl.pos = "lt")

```

# Conclusion
  In this report, exchange rate, interest rate and housing price index believed to be related to each other were analyzed monthly between 2013 and  2021 by visualizing these data and looking at their correlations. They are then normalized to be displayed on a single plot.
  Although these data directly affect each other in theory, their relationships may change due to the fact that other factors are not constant. Throughout this report:
-It has been observed that all 3 data tend to increase and are in a positive relationship with each other.
-It has been discovered that there is an almost perfect correlation between the exchange rate and the interest rate.
-The economic decisions in 2019 and the pandemic were effective in the change in the interest rate.
-The interest rate showed a much more fluctuating trend compared to the other 2 data.
-When we look at the correlation for each year, there is a continuous positive correlation between the price index and the exchange rate, except for 2014. On the other hand, although the relationship between exchange rates and interest rates is positive in total, there is a negative correlation in 2016-2019 and 2022.
-The correlation between the price index and the interest rate is constantly changing.

# References

- *1.* [inflation-interest-rate-relationship](https://www.investopedia.com/ask/answers/12/inflation-interest-rate-relationship.asp#:~:text=In%20general%2C%20higher%20interest%20rates,rates%20to%20stimulate%20the%20economy.)
- *2.* [Definition of inflation rate](https://tr.wikipedia.org/wiki/Enflasyon)

# Appendices

 - *1.* [Rmd file]() for the report.